(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{102:function(t,e,n){},103:function(t,e,n){},104:function(t,e,n){},106:function(t,e,n){"use strict";n.r(e);var a=n(18),r=n.n(a),o=n(54),c=n(0),u=n.n(c),i=n(7),l=n.n(i),s=n(14),f=n(62),p=function(t){var e=t.id;return u.a.createElement("svg",{id:e})},h=n(55),d=n.n(h),m=function(t,e){return{label:t,value:e}},v=function(t){var e=t.options,n=(t.id,t.className),a=t.defaultValue,r=t.onChange,o=t.placeholderButtonLabel,c=e.map((function(t){return m(t,t)}));return u.a.createElement("div",{className:n},u.a.createElement(d.a,{options:c,defaultValue:m(a,a),onChange:r,placeholderButtonLabel:o}))},y=function(t){var e=t.options,n=t.onChange;return u.a.createElement(v,{options:e,className:"select-wrapper",defaultValue:e[0],placeholderButtonLabel:"Local authority",onChange:n})},g=function(t){var e=t.dates,n=t.onChange;return u.a.createElement(v,{options:e,className:"select-wrapper",defaultValue:e[0],placeholderButtonLabel:"Date Range",onChange:n})},O=function(t){var e=t.options,n=t.onChange;return u.a.createElement(v,{options:e,className:"select-wrapper",defaultValue:e[0],placeholderButtonLabel:"Site of Loan",onChange:n})};var b=function(t){var e=t.map((function(t){return t.value}));if(0===e.indexOf("All")&&t.length>1)t.splice(0,1);else if(e.indexOf("All")===t.length-1)for(;t.length>1;)t.shift();return t},x=n(4),j=n(9);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(n,!0).forEach((function(e){Object(s.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L=function(t){var e=t.map((function(t){return t["Site of loan"]}));return Object(j.a)(new Set(e)).forEach((function(n){var a=e.filter((function(t){return t===n})).length;if(a>1)for(var r=0;r<a;r++){var o=t.map((function(t){return t["Site of loan"]})).indexOf(n);t[o]["Site of loan"]="".concat(n," (").concat(r+1,")")}})),t};var S=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.localAuthorities,r=e.dates,o=e.siteOfLoans,c=[];return a.forEach((function(e){var a=t.map((function(t){return t["Local authority"]})).indexOf(e);r.forEach((function(r){var u=t[a].values.map((function(t){return t.Dates})).indexOf(r),i=n?t[a].values[u].values.map((function(t){return E({},t,{Dates:r,"Local authority":e})})):t[a].values[u].values.filter((function(t){return o.includes(t["Site of loan"])||o.includes("All")})).map((function(t){return E({},t,{Dates:r,"Local authority":e})}));c.push.apply(c,Object(j.a)(i))}))})),L(c)},D=n(1);var P=function(t,e){for(var n=t.text().split(/\s+/).reverse(),a="",r=[],o=0,c=t.attr("y"),u=+t.attr("dy").slice(0,-3),i=1,l=t.text(null).append("tspan").attr("x",0).attr("y",c).attr("dy",u+"em");a=n.pop();)r.push(a),l.text(r.join(" ")),l.node().getComputedTextLength()>e&&(r.pop(),l.text(r.join(" ")),r=[a],l=t.append("tspan").attr("x",0).attr("y",c).attr("dy",1.1*++o+u+"em").text(a),function t(){l.node().getComputedTextLength()>e&&(i*=.99,Object(D.g)(".x-axis-text").style("font-size","".concat(i,"em")),t())}())},k=n(59),C=Object(k.a)().attr("class","d3-tip").html((function(t){return function(t){var e=Object.keys(t),n="";return e.forEach((function(e){var a,r=t[e];n+=(a=r,"<p class='tt'>".concat(e,": ").concat(a,"</p>"))})),n}(t)}));var A=function(t,e){var n=S(t,e);x.h("#chart").selectAll("*").remove();var a=40,r=10,o=90,c=70,u=1e3-c-r,i=600-a-o,l=x.g,s=x.e().range([0,u]).domain(n.map((function(t){return t["Site of loan"]}))).padding(.1),f=s.bandwidth(),p=x.f().range([i,0]).domain([0,x.c(n.map((function(t){return t.Issues})))]),h=x.h("#chart").attr("width",u+c+r).attr("height",i+a+o).append("g").attr("transform","translate(".concat(c,", ").concat(a,")"));h.call(C),h.selectAll(".bar").data(n).enter().append("rect").attr("class","bar").attr("x",(function(t){return s(t["Site of loan"])})).attr("width",f).attr("y",(function(t){return p(t.Issues)})).attr("height",(function(t){return i-p(t.Issues)})).style("fill",(function(t,e){return l[e%l.length]})).on("mouseover",C.show).on("mouseout",C.hide);var d=x.a(s);h.append("g").attr("transform","translate(0, ".concat(i,")")).call(d).each((function(){x.h(this).selectAll(".tick text").classed("x-axis-text",!0).each((function(){P(x.h(this),f)}))})),h.append("g").call(x.b(p)),h.append("text").attr("class","legend").attr("transform","translate(".concat(u/2,", ").concat(i+o-20,")")).attr("alignment-baseline","middle").style("text-anchor","middle").text("Site of loan"),h.append("text").attr("class","legend").attr("transform","rotate(-90)").attr("y",0-c+5).attr("x",0-i/2).attr("dy","1em").style("text-anchor","middle").text("Loans + renewals in a timeframe"),h.append("text").attr("class","chart-title").attr("y",0-.25*a).attr("x",u/2).style("text-anchor","middle").text("Issues + Renewals by Loan Site")},I=function(t){return t.map((function(t){return function(t){var e=t.indexOf("(");return-1===e?t:t.slice(0,e-1)}(t)}))},B=function(t,e){var n=S(t,e,!0).map((function(t){return t["Site of loan"]})),a=I(n);return["All"].concat(Object(j.a)(new Set(a)))},N=function(t,e){for(var n=[],a=t.map((function(t){return t["Local authority"]})),r=0;r<e.length;r++){var o=e[r];t[a.indexOf(o)].values.forEach((function(t){return n.push(t.Dates)}))}return n};n(102);function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}var J=function(t){var e=t.data,n=e.map((function(t){return t["Local authority"]})),a=n[0],r=N(e,[a])[0],o=Object(c.useState)({localAuthorities:[a],dates:[r],siteOfLoans:["All"]}),i=Object(f.a)(o,2),l=i[0],h=i[1];Object(c.useEffect)((function(){A(e,l)}));return u.a.createElement("div",null,u.a.createElement("div",{className:"filter-wrapper"},u.a.createElement(y,{options:n,onChange:function(t){var n=t.map((function(t){return t.value})),a={localAuthorities:n,dates:[N(e,n)[0]],siteOfLoans:l.siteOfLoans};h(a),A(e,a)}}),u.a.createElement(g,{dates:N(e,l.localAuthorities),onChange:function(t){var n=t.map((function(t){return t.value})),a=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(n,!0).forEach((function(e){Object(s.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},l,{dates:n});h(a),A(e,a)}}),u.a.createElement(O,{options:B(e,l),onChange:function(t){var n=b(t).map((function(t){return t.value})),a=l;a.siteOfLoans=I(n),h(a),A(e,a)}})),u.a.createElement("div",{className:"chart-wrapper"},u.a.createElement(p,{id:"chart"})))},R=(n(103),n(104),function(){return u.a.createElement("header",null,u.a.createElement("h1",null,"UK Library Issues"))}),T=function(t){var e=t.data;return u.a.createElement(c.Fragment,null,u.a.createElement(R,null),u.a.createElement("main",null,u.a.createElement(J,{data:e})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var W=n(60),z=n.n(W),F=n(13),K=(n(105),function(t){return t["Count start"]+" - "+t["Count end"]}),U=function(t){for(var e=[],n=0;n<t.length;n++){var a=t[n],r=K(a);a.Dates=r,e.push(a)}return Object(x.d)().key((function(t){return t["Local authority"]})).key((function(t){return t.Dates})).key((function(t){return t["Site of loan"]})).rollup((function(t){return Object(x.i)(t.map((function(t){return t.Issues})))})).entries(e).map((function(t){return{"Local authority":t.key,values:t.values.map((function(t){return{Dates:t.key,values:t.values.map((function(t){return{"Site of loan":t.key,Issues:t.value}}))}}))}}))};(function(){var t=Object(o.a)(r.a.mark((function t(){var e,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(F.a)(z.a);case 2:e=t.sent,n=U(e),l.a.render(u.a.createElement(T,{data:n}),document.getElementById("root"));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},60:function(t,e,n){t.exports=n.p+"static/media/issues.b44bac97.csv"},76:function(t,e,n){t.exports=n(106)}},[[76,1,2]]]);
//# sourceMappingURL=main.7198bb97.chunk.js.map